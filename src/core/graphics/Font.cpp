#include "Font.h"

#include <utils.h>

namespace lb {

Font::Font(GlyphList glyphs, int glyphWidth, int glyphHeight,
           int horizontalSpacing) {
  this->glyphs = glyphs;
  this->glyphWidth = clamp(glyphWidth, 1, 8);
  this->glyphHeight = clamp(glyphHeight, 1, 8);
  this->horizontalSpacing = clamp(horizontalSpacing, 1, 8);
}

auto Font::getGlyphs() const -> const GlyphList& { return this->glyphs; }

auto Font::getGlyphWidth() const -> int { return this->glyphWidth; }

auto Font::getGlyphHeight() const -> int { return this->glyphHeight; }

auto Font::getHorizontalSpacing() const -> int {
  return this->horizontalSpacing;
}

auto Font::getGlyph(char c) const -> const Glyph& {
  int code = static_cast<int>(c);

  if (code < 32 || code > 126) {
    code = 32;
  }

  return this->glyphs[code - 32];
}

const GlyphList DEFAULT_FONT_GLYPHS = {
  // ASCII 32: Space
  Glyph{"00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 33: !
  Glyph{"00100"
        "00100"
        "00100"
        "00100"
        "00100"
        "00000"
        "00100"
        "00000"},
  // ASCII 34: "
  Glyph{"01010"
        "01010"
        "01010"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 35: #
  Glyph{"01010"
        "11111"
        "01010"
        "01010"
        "11111"
        "01010"
        "00000"
        "00000"},
  // ASCII 36: $
  Glyph{"00100"
        "01111"
        "10100"
        "01110"
        "00101"
        "11110"
        "00100"
        "00000"},
  // ASCII 37: %
  Glyph{"00000"
        "11001"
        "11010"
        "00100"
        "01011"
        "10011"
        "00000"
        "00000"},
  // ASCII 38: &
  Glyph{"01100"
        "10000"
        "01101"
        "10010"
        "10010"
        "01101"
        "00000"
        "00000"},
  // ASCII 39: '
  Glyph{"00100"
        "00100"
        "00100"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 40: (
  Glyph{"00010"
        "00100"
        "00100"
        "00100"
        "00100"
        "00010"
        "00000"
        "00000"},
  // ASCII 41: )
  Glyph{"01000"
        "00100"
        "00100"
        "00100"
        "00100"
        "01000"
        "00000"
        "00000"},
  // ASCII 42: *
  Glyph{"00000"
        "00100"
        "01110"
        "00100"
        "01010"
        "00000"
        "00000"
        "00000"},
  // ASCII 43: +
  Glyph{"00000"
        "00000"
        "00100"
        "01110"
        "00100"
        "00000"
        "00000"
        "00000"},
  // ASCII 44: ,
  Glyph{"00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00100"
        "01000"
        "00000"},
  // ASCII 45: -
  Glyph{"00000"
        "00000"
        "00000"
        "01110"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 46: .
  Glyph{"00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00100"
        "00000"
        "00000"},
  // ASCII 47: /
  Glyph{"00000"
        "00001"
        "00010"
        "00100"
        "01000"
        "10000"
        "00000"
        "00000"},
  // ASCII 48: 0
  Glyph{"01110"
        "10011"
        "10101"
        "10101"
        "11001"
        "01110"
        "00000"
        "00000"},
  // ASCII 49: 1
  Glyph{"00100"
        "01100"
        "10100"
        "00100"
        "00100"
        "11111"
        "00000"
        "00000"},
  // ASCII 50: 2
  Glyph{"01110"
        "10001"
        "00010"
        "00100"
        "01000"
        "11111"
        "00000"
        "00000"},
  // ASCII 51: 3
  Glyph{"11110"
        "00001"
        "00110"
        "00001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 52: 4
  Glyph{"00010"
        "00100"
        "01001"
        "11111"
        "00001"
        "00001"
        "00000"
        "00000"},
  // ASCII 53: 5
  Glyph{"11111"
        "10000"
        "11110"
        "00001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 54: 6
  Glyph{"01100"
        "10000"
        "11110"
        "10001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 55: 7
  Glyph{"11111"
        "00001"
        "00010"
        "00100"
        "01000"
        "10000"
        "00000"
        "00000"},
  // ASCII 56: 8
  Glyph{"01110"
        "10001"
        "01110"
        "10001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 57: 9
  Glyph{"01110"
        "10001"
        "10001"
        "01111"
        "00001"
        "00110"
        "00000"
        "00000"},
  // ASCII 58: :
  Glyph{"00000"
        "00000"
        "00000"
        "00100"
        "00000"
        "00100"
        "00000"
        "00000"},
  // ASCII 59: ;
  Glyph{"00000"
        "00000"
        "00000"
        "00100"
        "00000"
        "00100"
        "01000"
        "00000"},
  // ASCII 60: <
  Glyph{"00000"
        "00010"
        "00100"
        "01000"
        "00100"
        "00010"
        "00000"
        "00000"},
  // ASCII 61: =
  Glyph{"00000"
        "00000"
        "01110"
        "00000"
        "01110"
        "00000"
        "00000"
        "00000"},
  // ASCII 62: >
  Glyph{"00000"
        "01000"
        "00100"
        "00010"
        "00100"
        "01000"
        "00000"
        "00000"},
  // ASCII 63: ?
  Glyph{"01110"
        "10001"
        "00001"
        "00110"
        "00100"
        "00000"
        "00100"
        "00000"},
  // ASCII 64: @
  Glyph{"01110"
        "10001"
        "10111"
        "10111"
        "10000"
        "01110"
        "00000"
        "00000"},
  // ASCII 65: A
  Glyph{"01110"
        "10001"
        "10001"
        "11111"
        "10001"
        "10001"
        "00000"
        "00000"},
  // ASCII 66: B
  Glyph{"11110"
        "10001"
        "11110"
        "10001"
        "10001"
        "11110"
        "00000"
        "00000"},
  // ASCII 67: C
  Glyph{"01111"
        "10000"
        "10000"
        "10000"
        "10000"
        "01111"
        "00000"
        "00000"},
  // ASCII 68: D
  Glyph{"11110"
        "10001"
        "10001"
        "10001"
        "10001"
        "11110"
        "00000"
        "00000"},
  // ASCII 69: E
  Glyph{"11111"
        "10000"
        "11110"
        "10000"
        "10000"
        "11111"
        "00000"
        "00000"},
  // ASCII 70: F
  Glyph{"11111"
        "10000"
        "11110"
        "10000"
        "10000"
        "10000"
        "00000"
        "00000"},
  // ASCII 71: G
  Glyph{"01111"
        "10000"
        "10000"
        "10011"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 72: H
  Glyph{"10001"
        "10001"
        "11111"
        "10001"
        "10001"
        "10001"
        "00000"
        "00000"},
  // ASCII 73: I
  Glyph{"11111"
        "00100"
        "00100"
        "00100"
        "00100"
        "11111"
        "00000"
        "00000"},
  // ASCII 74: J
  Glyph{"11111"
        "00010"
        "00010"
        "00010"
        "10010"
        "01100"
        "00000"
        "00000"},
  // ASCII 75: K
  Glyph{"10001"
        "10010"
        "11100"
        "10010"
        "10001"
        "10001"
        "00000"
        "00000"},
  // ASCII 76: L
  Glyph{"10000"
        "10000"
        "10000"
        "10000"
        "10000"
        "11111"
        "00000"
        "00000"},
  // ASCII 77: M
  Glyph{"11011"
        "10101"
        "10101"
        "10101"
        "10001"
        "10001"
        "00000"
        "00000"},
  // ASCII 78: N
  Glyph{"10001"
        "11001"
        "10101"
        "10011"
        "10011"
        "10001"
        "00000"
        "00000"},
  // ASCII 79: O
  Glyph{"01110"
        "10001"
        "10001"
        "10001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 80: P
  Glyph{"11110"
        "10001"
        "10001"
        "11110"
        "10000"
        "10000"
        "00000"
        "00000"},
  // ASCII 81: Q
  Glyph{"01110"
        "10001"
        "10001"
        "10001"
        "10101"
        "01110"
        "00011"
        "00000"},
  // ASCII 82: R
  Glyph{"11110"
        "10001"
        "10001"
        "11110"
        "10010"
        "10001"
        "00000"
        "00000"},
  // ASCII 83: S
  Glyph{"01110"
        "10001"
        "01100"
        "00010"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 84: T
  Glyph{"11111"
        "00100"
        "00100"
        "00100"
        "00100"
        "00100"
        "00000"
        "00000"},
  // ASCII 85: U
  Glyph{"10001"
        "10001"
        "10001"
        "10001"
        "10001"
        "01110"
        "00000"
        "00000"},
  // ASCII 86: V
  Glyph{"10001"
        "10001"
        "10001"
        "10001"
        "01010"
        "00100"
        "00000"
        "00000"},
  // ASCII 87: W
  Glyph{"10001"
        "10001"
        "10101"
        "10101"
        "10101"
        "11011"
        "00000"
        "00000"},
  // ASCII 88: X
  Glyph{"10001"
        "01010"
        "00100"
        "00100"
        "01010"
        "10001"
        "00000"
        "00000"},
  // ASCII 89: Y
  Glyph{"10001"
        "01010"
        "00100"
        "00100"
        "00100"
        "00100"
        "00000"
        "00000"},
  // ASCII 90: Z
  Glyph{"11111"
        "00001"
        "00010"
        "00100"
        "01000"
        "11111"
        "00000"
        "00000"},
  // ASCII 91: [
  Glyph{"00110"
        "00100"
        "00100"
        "00100"
        "00100"
        "00110"
        "00000"
        "00000"},
  // ASCII 92: Backslash
  Glyph{"00000"
        "10000"
        "01000"
        "00100"
        "00010"
        "00001"
        "00000"
        "00000"},
  // ASCII 93: ]
  Glyph{"01100"
        "00100"
        "00100"
        "00100"
        "00100"
        "01100"
        "00000"
        "00000"},
  // ASCII 94: ^
  Glyph{"00100"
        "01010"
        "10001"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 95: _
  Glyph{"00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "11111"
        "00000"
        "00000"},
  // ASCII 96: `
  Glyph{"01000"
        "00100"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"
        "00000"},
  // ASCII 97: a
  Glyph{"00000"
        "00000"
        "00110"
        "11110"
        "10010"
        "01110"
        "00000"
        "00000"},
  // ASCII 98: b
  Glyph{"00000"
        "10000"
        "10000"
        "11100"
        "10010"
        "11100"
        "00000"
        "00000"},
  // ASCII 99: c
  Glyph{"00000"
        "00000"
        "01110"
        "10000"
        "10000"
        "01110"
        "00000"
        "00000"},
  // ASCII 100: d
  Glyph{"00000"
        "00010"
        "00010"
        "01110"
        "10010"
        "01110"
        "00000"
        "00000"},
  // ASCII 101: e
  Glyph{"00000"
        "00000"
        "01100"
        "10010"
        "10100"
        "01110"
        "00000"
        "00000"},
  // ASCII 102: f
  Glyph{"00000"
        "00110"
        "01000"
        "11100"
        "01000"
        "01000"
        "10000"
        "00000"},
  // ASCII 103: g
  Glyph{"00000"
        "00000"
        "01110"
        "10010"
        "10010"
        "01110"
        "00010"
        "11100"},
  // ASCII 104: h
  Glyph{"00000"
        "10000"
        "10000"
        "11100"
        "10010"
        "10010"
        "00000"
        "00000"},
  // ASCII 105: i
  Glyph{"00000"
        "00100"
        "00000"
        "01100"
        "00100"
        "01110"
        "00000"
        "00000"},
  // ASCII 106: j
  Glyph{"00000"
        "00100"
        "00000"
        "00110"
        "00100"
        "00100"
        "00100"
        "01000"},
  // ASCII 107: k
  Glyph{"00000"
        "10000"
        "10010"
        "10100"
        "11100"
        "10010"
        "00000"
        "00000"},
  // ASCII 108: l
  Glyph{"00000"
        "01100"
        "00100"
        "00100"
        "00100"
        "00010"
        "00000"
        "00000"},
  // ASCII 109: m
  Glyph{"00000"
        "00000"
        "11010"
        "10101"
        "10101"
        "10001"
        "00000"
        "00000"},
  // ASCII 110: n
  Glyph{"00000"
        "00000"
        "11100"
        "10010"
        "10010"
        "10010"
        "00000"
        "00000"},
  // ASCII 111: o
  Glyph{"00000"
        "00000"
        "01100"
        "10010"
        "10010"
        "01100"
        "00000"
        "00000"},
  // ASCII 112: p
  Glyph{"00000"
        "00000"
        "01100"
        "10010"
        "10010"
        "11100"
        "10000"
        "10000"},
  // ASCII 113: q
  Glyph{"00000"
        "00000"
        "01110"
        "10010"
        "10010"
        "01110"
        "00010"
        "00010"},
  // ASCII 114: r
  Glyph{"00000"
        "00000"
        "11100"
        "10010"
        "10000"
        "10000"
        "00000"
        "00000"},
  // ASCII 115: s
  Glyph{"00000"
        "00000"
        "01110"
        "11000"
        "00110"
        "11100"
        "00000"
        "00000"},
  // ASCII 116: t
  Glyph{"00000"
        "01000"
        "11110"
        "01000"
        "01000"
        "00110"
        "00000"
        "00000"},
  // ASCII 117: u
  Glyph{"00000"
        "00000"
        "10010"
        "10010"
        "10010"
        "11100"
        "00000"
        "00000"},
  // ASCII 118: v
  Glyph{"00000"
        "00000"
        "10010"
        "10010"
        "10100"
        "11000"
        "00000"
        "00000"},
  // ASCII 119: w
  Glyph{"00000"
        "00000"
        "10001"
        "10101"
        "10101"
        "01010"
        "00000"
        "00000"},
  // ASCII 120: x
  Glyph{"00000"
        "00000"
        "11011"
        "00100"
        "00100"
        "11011"
        "00000"
        "00000"},
  // ASCII 121: y
  Glyph{"00000"
        "00000"
        "10010"
        "10010"
        "10010"
        "01110"
        "00010"
        "11100"},
  // ASCII 122: z
  Glyph{"00000"
        "00000"
        "11110"
        "00100"
        "01000"
        "11110"
        "00000"
        "00000"},
  // ASCII 123: {
  Glyph{"00110"
        "00100"
        "01100"
        "01100"
        "00100"
        "00110"
        "00000"
        "00000"},
  // ASCII 124: |
  Glyph{"00100"
        "00100"
        "00100"
        "00100"
        "00100"
        "00100"
        "00000"
        "00000"},
  // ASCII 125: }
  Glyph{"01100"
        "00100"
        "00110"
        "00110"
        "00100"
        "01100"
        "00000"
        "00000"},
  // ASCII 126: ~
  Glyph{"00000"
        "00000"
        "01101"
        "10110"
        "00000"
        "00000"
        "00000"
        "00000"},
};

const Font DEFAULT_FONT = {DEFAULT_FONT_GLYPHS, 5, 8, 1};

}  // namespace lb